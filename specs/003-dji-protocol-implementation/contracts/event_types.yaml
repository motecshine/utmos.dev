# DJI Event Types Contract

# 事件类型定义
# 格式: method -> module, description, need_reply, data_type

event_types:
  # ==================== 设备事件 (device) ====================
  device_exit_homing_notify:
    module: device
    description: 退出归位通知
    need_reply: false
    data_type: DeviceExitHomingData

  device_temp_ntfy_need_clear:
    module: device
    description: 温度通知需清除
    need_reply: false
    data_type: DeviceTempNotifyData

  file_upload_callback:
    module: device
    description: 文件上传回调
    need_reply: true
    data_type: FileUploadCallbackData

  # ==================== 航线事件 (wayline) ====================
  flighttask_progress:
    module: wayline
    description: 航线任务进度
    need_reply: false
    data_type: FlightTaskProgressData

  flighttask_ready:
    module: wayline
    description: 航线任务就绪
    need_reply: true
    data_type: FlightTaskReadyData

  return_home_info:
    module: wayline
    description: 返航信息
    need_reply: false
    data_type: ReturnHomeInfoData

  # ==================== HMS 事件 (aircraft) ====================
  hms:
    module: aircraft
    description: 健康管理系统通知
    need_reply: false
    data_type: HMSData

  # ==================== DRC 事件 (drc) ====================
  joystick_invalid_notify:
    module: drc
    description: 摇杆无效通知
    need_reply: false
    data_type: JoystickInvalidData

  drc_status_notify:
    module: drc
    description: DRC 状态通知
    need_reply: false
    data_type: DRCStatusData

  # ==================== 文件事件 (file) ====================
  highest_priority_upload_flighttask_media:
    module: file
    description: 高优先级上传航线媒体
    need_reply: true
    data_type: HighPriorityUploadData

  file_upload_progress:
    module: file
    description: 文件上传进度
    need_reply: false
    data_type: FileUploadProgressData

  fileupload_progress:
    module: file
    description: 文件上传进度 (别名)
    need_reply: false
    data_type: FileUploadProgressData

  # ==================== 固件事件 (firmware) ====================
  ota_progress:
    module: firmware
    description: OTA 升级进度
    need_reply: false
    data_type: OTAProgressData

  # ==================== 日志事件 (file) ====================
  device_log_upload_progress:
    module: file
    description: 设备日志上传进度
    need_reply: false
    data_type: LogUploadProgressData

# 事件数据类型定义
data_types:
  FlightTaskProgressData:
    fields:
      - name: flight_id
        type: string
        description: 任务 ID
      - name: percent
        type: int
        description: 进度百分比 (0-100)
      - name: status
        type: string
        description: 任务状态
      - name: waypoint_index
        type: int
        description: 当前航点索引
      - name: media_count
        type: int
        description: 媒体文件数量

  FlightTaskReadyData:
    fields:
      - name: flight_id
        type: string
        description: 任务 ID

  HMSData:
    fields:
      - name: list
        type: array
        description: HMS 告警列表
        items:
          - name: code
            type: string
            description: 告警码
          - name: level
            type: int
            description: 告警级别 (0=通知, 1=注意, 2=警告, 3=严重)
          - name: module
            type: int
            description: 模块 ID
          - name: in_the_sky
            type: int
            description: 是否在空中 (0=否, 1=是)

  OTAProgressData:
    fields:
      - name: device_sn
        type: string
        description: 设备序列号
      - name: product_version
        type: string
        description: 目标版本
      - name: status
        type: string
        description: 升级状态
      - name: progress
        type: int
        description: 进度百分比

  FileUploadProgressData:
    fields:
      - name: file_path
        type: string
        description: 文件路径
      - name: progress
        type: int
        description: 上传进度
      - name: result
        type: int
        description: 结果码

  DRCStatusData:
    fields:
      - name: result
        type: int
        description: DRC 状态码
      - name: reason
        type: int
        description: 原因码
